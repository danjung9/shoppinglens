{"version":3,"sources":["../../src/telemetry/logging.ts"],"sourcesContent":["// SPDX-FileCopyrightText: 2025 LiveKit, Inc.\n//\n// SPDX-License-Identifier: Apache-2.0\nimport type { Attributes } from '@opentelemetry/api';\nimport type { LogRecord, LogRecordProcessor } from '@opentelemetry/sdk-logs';\n\n/**\n * Metadata log processor that injects metadata (room_id, job_id) into all log records.\n */\nexport class MetadataLogProcessor implements LogRecordProcessor {\n  private metadata: Attributes;\n\n  constructor(metadata: Attributes) {\n    this.metadata = metadata;\n  }\n\n  onEmit(logRecord: LogRecord): void {\n    // Add metadata to log record attributes\n    if (logRecord.attributes) {\n      Object.assign(logRecord.attributes, this.metadata);\n    } else {\n      (logRecord as any).attributes = { ...this.metadata };\n    }\n  }\n\n  shutdown(): Promise<void> {\n    return Promise.resolve();\n  }\n\n  forceFlush(): Promise<void> {\n    return Promise.resolve();\n  }\n}\n\n/**\n * Extra details processor that adds logger name to log records.\n */\nexport class ExtraDetailsProcessor implements LogRecordProcessor {\n  onEmit(logRecord: LogRecord): void {\n    const loggerName = logRecord.instrumentationScope.name;\n    if (logRecord.attributes) {\n      (logRecord.attributes as any)['logger.name'] = loggerName;\n    } else {\n      (logRecord as any).attributes = { 'logger.name': loggerName };\n    }\n  }\n\n  shutdown(): Promise<void> {\n    return Promise.resolve();\n  }\n\n  forceFlush(): Promise<void> {\n    return Promise.resolve();\n  }\n}\n"],"mappings":"AASO,MAAM,qBAAmD;AAAA,EACtD;AAAA,EAER,YAAY,UAAsB;AAChC,SAAK,WAAW;AAAA,EAClB;AAAA,EAEA,OAAO,WAA4B;AAEjC,QAAI,UAAU,YAAY;AACxB,aAAO,OAAO,UAAU,YAAY,KAAK,QAAQ;AAAA,IACnD,OAAO;AACL,MAAC,UAAkB,aAAa,EAAE,GAAG,KAAK,SAAS;AAAA,IACrD;AAAA,EACF;AAAA,EAEA,WAA0B;AACxB,WAAO,QAAQ,QAAQ;AAAA,EACzB;AAAA,EAEA,aAA4B;AAC1B,WAAO,QAAQ,QAAQ;AAAA,EACzB;AACF;AAKO,MAAM,sBAAoD;AAAA,EAC/D,OAAO,WAA4B;AACjC,UAAM,aAAa,UAAU,qBAAqB;AAClD,QAAI,UAAU,YAAY;AACxB,MAAC,UAAU,WAAmB,aAAa,IAAI;AAAA,IACjD,OAAO;AACL,MAAC,UAAkB,aAAa,EAAE,eAAe,WAAW;AAAA,IAC9D;AAAA,EACF;AAAA,EAEA,WAA0B;AACxB,WAAO,QAAQ,QAAQ;AAAA,EACzB;AAAA,EAEA,aAA4B;AAC1B,WAAO,QAAQ,QAAQ;AAAA,EACzB;AACF;","names":[]}