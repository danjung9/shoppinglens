{"version":3,"sources":["../../src/llm/chat_context.test.ts"],"sourcesContent":["// SPDX-FileCopyrightText: 2025 LiveKit, Inc.\n//\n// SPDX-License-Identifier: Apache-2.0\nimport { describe, expect, it } from 'vitest';\nimport {\n  type AudioContent,\n  ChatContext,\n  type ChatItem,\n  ChatMessage,\n  FunctionCall,\n  FunctionCallOutput,\n  type ImageContent,\n  ReadonlyChatContext,\n} from './chat_context.js';\n\ndescribe('ChatContext.toJSON', () => {\n  it('should match snapshot for empty context', () => {\n    const context = new ChatContext();\n    expect(context.toJSON()).toMatchSnapshot();\n  });\n\n  it('should match snapshot for simple conversation', () => {\n    const context = new ChatContext();\n\n    context.addMessage({\n      id: 'msg_system_1',\n      role: 'system',\n      content: 'You are a helpful assistant.',\n      createdAt: 1000000000,\n    });\n\n    context.addMessage({\n      id: 'msg_user_1',\n      role: 'user',\n      content: 'Hello, how are you?',\n      createdAt: 1000000001,\n    });\n\n    context.addMessage({\n      id: 'msg_assistant_1',\n      role: 'assistant',\n      content: \"I'm doing well, thank you! How can I help you today?\",\n      createdAt: 1000000002,\n    });\n\n    expect(context.toJSON()).toMatchSnapshot('simple-conversation-no-timestamps');\n\n    expect(context.toJSON({ excludeTimestamp: false })).toMatchSnapshot(\n      'simple-conversation-with-timestamps',\n    );\n  });\n\n  it('should match snapshot for multimodal content', () => {\n    const context = new ChatContext();\n\n    const imageContent: ImageContent = {\n      id: 'img_test_1',\n      type: 'image_content',\n      image: 'https://example.com/test-image.jpg',\n      inferenceDetail: 'high',\n      inferenceWidth: 1024,\n      inferenceHeight: 768,\n      mimeType: 'image/jpeg',\n      _cache: {},\n    };\n\n    const audioContent: AudioContent = {\n      type: 'audio_content',\n      frame: [], // This won't be included in JSON\n      transcript: 'This is a test audio transcript',\n    };\n\n    context.addMessage({\n      id: 'msg_user_2',\n      role: 'user',\n      content: [\n        'Check out this image and audio:',\n        imageContent,\n        audioContent,\n        'What do you think?',\n      ],\n      createdAt: 2000000000,\n    });\n\n    expect(context.toJSON()).toMatchSnapshot('multimodal-default-exclusions');\n\n    expect(\n      context.toJSON({\n        excludeImage: false,\n        excludeAudio: true,\n      }),\n    ).toMatchSnapshot('multimodal-with-images-only');\n\n    expect(\n      context.toJSON({\n        excludeImage: true,\n        excludeAudio: false,\n      }),\n    ).toMatchSnapshot('multimodal-with-audio-only');\n\n    expect(\n      context.toJSON({\n        excludeImage: false,\n        excludeAudio: false,\n        excludeTimestamp: false,\n      }),\n    ).toMatchSnapshot('multimodal-full-content');\n  });\n\n  it('should match snapshot for function calls', () => {\n    const context = new ChatContext();\n\n    context.addMessage({\n      id: 'msg_user_3',\n      role: 'user',\n      content: \"What's the weather in Paris?\",\n      createdAt: 3000000000,\n    });\n\n    const functionCall = new FunctionCall({\n      id: 'func_call_1',\n      callId: 'call_weather_123',\n      name: 'get_weather',\n      args: '{\"location\": \"Paris, France\", \"unit\": \"celsius\"}',\n      createdAt: 3000000001,\n    });\n    context.insert(functionCall);\n\n    const functionOutput = new FunctionCallOutput({\n      id: 'func_output_1',\n      callId: 'call_weather_123',\n      name: 'get_weather',\n      output: '{\"temperature\": 22, \"condition\": \"partly cloudy\", \"humidity\": 65}',\n      isError: false,\n      createdAt: 3000000002,\n    });\n    context.insert(functionOutput);\n\n    context.addMessage({\n      id: 'msg_assistant_2',\n      role: 'assistant',\n      content: 'The weather in Paris is currently 22°C and partly cloudy with 65% humidity.',\n      createdAt: 3000000003,\n    });\n\n    expect(context.toJSON()).toMatchSnapshot('conversation-with-function-calls');\n\n    expect(\n      context.toJSON({\n        excludeFunctionCall: true,\n      }),\n    ).toMatchSnapshot('conversation-without-function-calls');\n\n    expect(\n      context.toJSON({\n        excludeTimestamp: false,\n      }),\n    ).toMatchSnapshot('conversation-with-function-calls-and-timestamps');\n  });\n\n  it('should match snapshot for edge cases', () => {\n    const context = new ChatContext();\n\n    context.addMessage({\n      id: 'msg_empty_1',\n      role: 'user',\n      content: [],\n      createdAt: 5000000000,\n    });\n\n    const silentAudio: AudioContent = {\n      type: 'audio_content',\n      frame: [],\n      transcript: undefined,\n    };\n\n    context.addMessage({\n      id: 'msg_silent_audio',\n      role: 'user',\n      content: [silentAudio],\n      createdAt: 5000000001,\n    });\n\n    context.addMessage({\n      id: 'msg_multi_text',\n      role: 'assistant',\n      content: ['Part 1. ', 'Part 2. ', 'Part 3.'],\n      createdAt: 5000000002,\n    });\n\n    const minimalCall = new FunctionCall({\n      id: 'func_minimal',\n      callId: 'minimal',\n      name: 'test',\n      args: '{}',\n      createdAt: 5000000003,\n    });\n    context.insert(minimalCall);\n\n    const namelessOutput = new FunctionCallOutput({\n      id: 'func_output_nameless',\n      callId: 'minimal',\n      output: 'OK',\n      isError: false,\n      createdAt: 5000000004,\n    });\n    context.insert(namelessOutput);\n\n    context.addMessage({\n      id: 'msg_special_chars',\n      role: 'user',\n      content:\n        'Test with special chars: \\n\\t\\r \"quotes\" \\'apostrophes\\' \\\\backslashes\\\\ {braces} [brackets]',\n      createdAt: 5000000005,\n    });\n\n    expect(context.toJSON()).toMatchSnapshot('edge-cases-default');\n    expect(\n      context.toJSON({\n        excludeTimestamp: false,\n        excludeAudio: false,\n      }),\n    ).toMatchSnapshot('edge-cases-with-details');\n  });\n\n  it('should match snapshot for message property variations', () => {\n    const context = new ChatContext();\n\n    context.addMessage({\n      id: 'custom-message-id-123',\n      role: 'user',\n      content: 'Message with custom ID',\n      createdAt: 6000000000,\n    });\n\n    context.addMessage({\n      id: 'msg_interrupted',\n      role: 'assistant',\n      content: 'This response was interrupted...',\n      interrupted: true,\n      createdAt: 6000000001,\n    });\n\n    context.addMessage({\n      id: 'msg_dev_2',\n      role: 'developer',\n      content: 'Developer message',\n      createdAt: 6000000002,\n    });\n\n    context.addMessage({\n      id: 'msg_system_3',\n      role: 'system',\n      content: 'System message',\n      createdAt: 6000000003,\n    });\n\n    const detailedImage: ImageContent = {\n      id: 'img_detailed',\n      type: 'image_content',\n      image: 'https://example.com/image.jpg',\n      inferenceDetail: 'low',\n      inferenceWidth: 512,\n      inferenceHeight: 512,\n      mimeType: 'image/png',\n      _cache: { cached: true },\n    };\n\n    context.addMessage({\n      id: 'msg_with_image',\n      role: 'user',\n      content: ['Image with all properties:', detailedImage],\n      createdAt: 6000000004,\n    });\n\n    expect(context.toJSON()).toMatchSnapshot('message-properties-default');\n    expect(\n      context.toJSON({\n        excludeImage: false,\n        excludeTimestamp: false,\n      }),\n    ).toMatchSnapshot('message-properties-full');\n  });\n});\n\ndescribe('ReadonlyChatContext with immutable array', () => {\n  it('should have readonly property set to true', () => {\n    const items: ChatItem[] = [\n      new ChatMessage({\n        id: 'msg_1',\n        role: 'user',\n        content: ['Test'],\n        interrupted: false,\n        createdAt: Date.now(),\n      }),\n    ];\n    const readonlyContext = new ReadonlyChatContext(items);\n\n    expect(readonlyContext.readonly).toBe(true);\n  });\n\n  it('should prevent setting items property', () => {\n    const items: ChatItem[] = [\n      new ChatMessage({\n        id: 'msg_1',\n        role: 'user',\n        content: ['Test'],\n        interrupted: false,\n        createdAt: Date.now(),\n      }),\n    ];\n    const readonlyContext = new ReadonlyChatContext(items);\n    expect(() => {\n      readonlyContext.items = [];\n    }).toThrow(\n      `Cannot set items on a read-only chat context. Please use .copy() and agent.update_chat_ctx() to modify the chat context.`,\n    );\n  });\n\n  it('should prevent modifications through array methods', () => {\n    const items: ChatItem[] = [\n      new ChatMessage({\n        id: 'msg_1',\n        role: 'user',\n        content: ['Test'],\n        interrupted: false,\n        createdAt: Date.now(),\n      }),\n    ];\n    const readonlyContext = new ReadonlyChatContext(items);\n    const newItem = new ChatMessage({\n      id: 'msg_2',\n      role: 'assistant',\n      content: ['Response'],\n      interrupted: false,\n      createdAt: Date.now(),\n    });\n\n    const mutableItems = readonlyContext.items;\n    expect(() => mutableItems.push(newItem)).toThrow(\n      'Cannot call push() on a read-only array. Please use .copy() and agent.update_chat_ctx() to modify the chat context.',\n    );\n\n    expect(() => mutableItems.pop()).toThrow(\n      'Cannot call pop() on a read-only array. Please use .copy() and agent.update_chat_ctx() to modify the chat context.',\n    );\n\n    expect(() => mutableItems.shift()).toThrow(\n      'Cannot call shift() on a read-only array. Please use .copy() and agent.update_chat_ctx() to modify the chat context.',\n    );\n\n    expect(() => mutableItems.unshift(newItem)).toThrow(\n      'Cannot call unshift() on a read-only array. Please use .copy() and agent.update_chat_ctx() to modify the chat context.',\n    );\n\n    expect(() => mutableItems.splice(0, 1)).toThrow(\n      'Cannot call splice() on a read-only array. Please use .copy() and agent.update_chat_ctx() to modify the chat context.',\n    );\n\n    expect(() => mutableItems.sort()).toThrow(\n      'Cannot call sort() on a read-only array. Please use .copy() and agent.update_chat_ctx() to modify the chat context.',\n    );\n\n    expect(() => mutableItems.reverse()).toThrow(\n      'Cannot call reverse() on a read-only array. Please use .copy() and agent.update_chat_ctx() to modify the chat context.',\n    );\n\n    expect(() => mutableItems.fill(newItem)).toThrow(\n      'Cannot call fill() on a read-only array. Please use .copy() and agent.update_chat_ctx() to modify the chat context.',\n    );\n\n    expect(() => mutableItems.copyWithin(0, 1)).toThrow(\n      'Cannot call copyWithin() on a read-only array. Please use .copy() and agent.update_chat_ctx() to modify the chat context.',\n    );\n  });\n\n  it('should prevent bracket notation assignment and deletion', () => {\n    const items: ChatItem[] = [\n      new ChatMessage({\n        id: 'msg_1',\n        role: 'user',\n        content: ['Test'],\n        interrupted: false,\n        createdAt: Date.now(),\n      }),\n    ];\n    const readonlyContext = new ReadonlyChatContext(items);\n    const newItem = new ChatMessage({\n      id: 'msg_2',\n      role: 'assistant',\n      content: ['Response'],\n      interrupted: false,\n      createdAt: Date.now(),\n    });\n\n    expect(() => {\n      readonlyContext.items[0] = newItem;\n    }).toThrow(\n      'Cannot assign to read-only array index \"0\". Please use .copy() and agent.update_chat_ctx() to modify the chat context.',\n    );\n\n    expect(() => {\n      delete readonlyContext.items[0];\n    }).toThrow(\n      'Cannot delete read-only array index \"0\". Please use .copy() and agent.update_chat_ctx() to modify the chat context.',\n    );\n\n    expect(() => {\n      readonlyContext.items[99] = newItem;\n    }).toThrow(\n      'Cannot assign to read-only array index \"99\". Please use .copy() and agent.update_chat_ctx() to modify the chat context.',\n    );\n  });\n\n  it('should allow read operations on the immutable array', () => {\n    const items: ChatItem[] = [\n      new ChatMessage({\n        id: 'msg_1',\n        role: 'user',\n        content: ['Test 1'],\n        interrupted: false,\n        createdAt: 1000,\n      }),\n      new ChatMessage({\n        id: 'msg_2',\n        role: 'assistant',\n        content: ['Test 2'],\n        interrupted: false,\n        createdAt: 2000,\n      }),\n    ];\n    const readonlyContext = new ReadonlyChatContext(items);\n\n    expect(readonlyContext.items.length).toBe(2);\n    expect(readonlyContext.items[0]).toEqual(items[0]);\n    expect(readonlyContext.items[1]).toEqual(items[1]);\n    expect(readonlyContext.items.find((item: ChatItem) => item.id === 'msg_2')).toEqual(items[1]);\n    expect(readonlyContext.items.map((item: ChatItem) => item.id)).toEqual(['msg_1', 'msg_2']);\n    expect(\n      readonlyContext.items.filter(\n        (item: ChatItem) => item.type === 'message' && item.role === 'user',\n      ),\n    ).toHaveLength(1);\n\n    // forEach should work for reading\n    const ids: string[] = [];\n    readonlyContext.items.forEach((item) => ids.push(item.id));\n    expect(ids).toEqual(['msg_1', 'msg_2']);\n  });\n});\n\ndescribe('ChatContext.isEquivalent', () => {\n  it('should return true for same reference', () => {\n    const ctx = new ChatContext();\n    ctx.addMessage({\n      id: 'msg_1',\n      role: 'user',\n      content: 'Hello',\n    });\n\n    expect(ctx.isEquivalent(ctx)).toBe(true);\n  });\n\n  it('should return true for identical empty contexts', () => {\n    const ctx1 = new ChatContext();\n    const ctx2 = new ChatContext();\n\n    expect(ctx1.isEquivalent(ctx2)).toBe(true);\n  });\n\n  it('should return false for contexts with different lengths', () => {\n    const ctx1 = new ChatContext();\n    ctx1.addMessage({\n      id: 'msg_1',\n      role: 'user',\n      content: 'Hello',\n    });\n\n    const ctx2 = new ChatContext();\n    ctx2.addMessage({\n      id: 'msg_1',\n      role: 'user',\n      content: 'Hello',\n    });\n    ctx2.addMessage({\n      id: 'msg_2',\n      role: 'assistant',\n      content: 'Hi',\n    });\n\n    expect(ctx1.isEquivalent(ctx2)).toBe(false);\n  });\n\n  it('should return false for contexts with different item IDs', () => {\n    const ctx1 = new ChatContext();\n    ctx1.addMessage({\n      id: 'msg_1',\n      role: 'user',\n      content: 'Hello',\n    });\n\n    const ctx2 = new ChatContext();\n    ctx2.addMessage({\n      id: 'msg_2',\n      role: 'user',\n      content: 'Hello',\n    });\n\n    expect(ctx1.isEquivalent(ctx2)).toBe(false);\n  });\n\n  it('should return false for contexts with different item types', () => {\n    const ctx1 = new ChatContext();\n    ctx1.addMessage({\n      id: 'msg_1',\n      role: 'user',\n      content: 'Hello',\n    });\n\n    const ctx2 = new ChatContext();\n    ctx2.insert(\n      new FunctionCall({\n        id: 'msg_1',\n        callId: 'call_1',\n        name: 'test',\n        args: '{}',\n      }),\n    );\n\n    expect(ctx1.isEquivalent(ctx2)).toBe(false);\n  });\n\n  describe('message comparison', () => {\n    it('should return true for identical messages', () => {\n      const ctx1 = new ChatContext();\n      ctx1.addMessage({\n        id: 'msg_1',\n        role: 'user',\n        content: 'Hello',\n        interrupted: false,\n      });\n\n      const ctx2 = new ChatContext();\n      ctx2.addMessage({\n        id: 'msg_1',\n        role: 'user',\n        content: 'Hello',\n        interrupted: false,\n      });\n\n      expect(ctx1.isEquivalent(ctx2)).toBe(true);\n    });\n\n    it('should return false for messages with different roles', () => {\n      const ctx1 = new ChatContext();\n      ctx1.addMessage({\n        id: 'msg_1',\n        role: 'user',\n        content: 'Hello',\n      });\n\n      const ctx2 = new ChatContext();\n      ctx2.addMessage({\n        id: 'msg_1',\n        role: 'assistant',\n        content: 'Hello',\n      });\n\n      expect(ctx1.isEquivalent(ctx2)).toBe(false);\n    });\n\n    it('should return false for messages with different interrupted flags', () => {\n      const ctx1 = new ChatContext();\n      ctx1.addMessage({\n        id: 'msg_1',\n        role: 'user',\n        content: 'Hello',\n        interrupted: false,\n      });\n\n      const ctx2 = new ChatContext();\n      ctx2.addMessage({\n        id: 'msg_1',\n        role: 'user',\n        content: 'Hello',\n        interrupted: true,\n      });\n\n      expect(ctx1.isEquivalent(ctx2)).toBe(false);\n    });\n\n    it('should return false for messages with different content', () => {\n      const ctx1 = new ChatContext();\n      ctx1.addMessage({\n        id: 'msg_1',\n        role: 'user',\n        content: 'Hello',\n      });\n\n      const ctx2 = new ChatContext();\n      ctx2.addMessage({\n        id: 'msg_1',\n        role: 'user',\n        content: 'World',\n      });\n\n      expect(ctx1.isEquivalent(ctx2)).toBe(false);\n    });\n\n    it('should return true for messages with identical array content', () => {\n      const ctx1 = new ChatContext();\n      ctx1.addMessage({\n        id: 'msg_1',\n        role: 'user',\n        content: ['Hello', 'World'],\n      });\n\n      const ctx2 = new ChatContext();\n      ctx2.addMessage({\n        id: 'msg_1',\n        role: 'user',\n        content: ['Hello', 'World'],\n      });\n\n      expect(ctx1.isEquivalent(ctx2)).toBe(true);\n    });\n\n    it('should return false for messages with different array content', () => {\n      const ctx1 = new ChatContext();\n      ctx1.addMessage({\n        id: 'msg_1',\n        role: 'user',\n        content: ['Hello', 'World'],\n      });\n\n      const ctx2 = new ChatContext();\n      ctx2.addMessage({\n        id: 'msg_1',\n        role: 'user',\n        content: ['Hello'],\n      });\n\n      expect(ctx1.isEquivalent(ctx2)).toBe(false);\n    });\n\n    it('should return true for messages with identical image content', () => {\n      const imageContent: ImageContent = {\n        id: 'img_1',\n        type: 'image_content',\n        image: 'https://example.com/image.jpg',\n        inferenceDetail: 'high',\n        inferenceWidth: 1024,\n        inferenceHeight: 768,\n        mimeType: 'image/jpeg',\n        _cache: {},\n      };\n\n      const ctx1 = new ChatContext();\n      ctx1.addMessage({\n        id: 'msg_1',\n        role: 'user',\n        content: ['Check this:', imageContent],\n      });\n\n      const ctx2 = new ChatContext();\n      ctx2.addMessage({\n        id: 'msg_1',\n        role: 'user',\n        content: ['Check this:', { ...imageContent }],\n      });\n\n      expect(ctx1.isEquivalent(ctx2)).toBe(true);\n    });\n\n    it('should return false for messages with different image content', () => {\n      const imageContent1: ImageContent = {\n        id: 'img_1',\n        type: 'image_content',\n        image: 'https://example.com/image1.jpg',\n        inferenceDetail: 'high',\n        _cache: {},\n      };\n\n      const imageContent2: ImageContent = {\n        id: 'img_2',\n        type: 'image_content',\n        image: 'https://example.com/image2.jpg',\n        inferenceDetail: 'high',\n        _cache: {},\n      };\n\n      const ctx1 = new ChatContext();\n      ctx1.addMessage({\n        id: 'msg_1',\n        role: 'user',\n        content: ['Check this:', imageContent1],\n      });\n\n      const ctx2 = new ChatContext();\n      ctx2.addMessage({\n        id: 'msg_1',\n        role: 'user',\n        content: ['Check this:', imageContent2],\n      });\n\n      expect(ctx1.isEquivalent(ctx2)).toBe(false);\n    });\n  });\n\n  describe('function call comparison', () => {\n    it('should return true for identical function calls', () => {\n      const ctx1 = new ChatContext();\n      ctx1.insert(\n        new FunctionCall({\n          id: 'func_1',\n          callId: 'call_1',\n          name: 'get_weather',\n          args: '{\"location\": \"Paris\"}',\n        }),\n      );\n\n      const ctx2 = new ChatContext();\n      ctx2.insert(\n        new FunctionCall({\n          id: 'func_1',\n          callId: 'call_1',\n          name: 'get_weather',\n          args: '{\"location\": \"Paris\"}',\n        }),\n      );\n\n      expect(ctx1.isEquivalent(ctx2)).toBe(true);\n    });\n\n    it('should return false for function calls with different names', () => {\n      const ctx1 = new ChatContext();\n      ctx1.insert(\n        new FunctionCall({\n          id: 'func_1',\n          callId: 'call_1',\n          name: 'get_weather',\n          args: '{}',\n        }),\n      );\n\n      const ctx2 = new ChatContext();\n      ctx2.insert(\n        new FunctionCall({\n          id: 'func_1',\n          callId: 'call_1',\n          name: 'get_time',\n          args: '{}',\n        }),\n      );\n\n      expect(ctx1.isEquivalent(ctx2)).toBe(false);\n    });\n\n    it('should return false for function calls with different call IDs', () => {\n      const ctx1 = new ChatContext();\n      ctx1.insert(\n        new FunctionCall({\n          id: 'func_1',\n          callId: 'call_1',\n          name: 'get_weather',\n          args: '{}',\n        }),\n      );\n\n      const ctx2 = new ChatContext();\n      ctx2.insert(\n        new FunctionCall({\n          id: 'func_1',\n          callId: 'call_2',\n          name: 'get_weather',\n          args: '{}',\n        }),\n      );\n\n      expect(ctx1.isEquivalent(ctx2)).toBe(false);\n    });\n\n    it('should return false for function calls with different arguments', () => {\n      const ctx1 = new ChatContext();\n      ctx1.insert(\n        new FunctionCall({\n          id: 'func_1',\n          callId: 'call_1',\n          name: 'get_weather',\n          args: '{\"location\": \"Paris\"}',\n        }),\n      );\n\n      const ctx2 = new ChatContext();\n      ctx2.insert(\n        new FunctionCall({\n          id: 'func_1',\n          callId: 'call_1',\n          name: 'get_weather',\n          args: '{\"location\": \"London\"}',\n        }),\n      );\n\n      expect(ctx1.isEquivalent(ctx2)).toBe(false);\n    });\n\n    it('should ignore timestamps', () => {\n      const ctx1 = new ChatContext();\n      ctx1.insert(\n        new FunctionCall({\n          id: 'func_1',\n          callId: 'call_1',\n          name: 'get_weather',\n          args: '{}',\n          createdAt: 1000,\n        }),\n      );\n\n      const ctx2 = new ChatContext();\n      ctx2.insert(\n        new FunctionCall({\n          id: 'func_1',\n          callId: 'call_1',\n          name: 'get_weather',\n          args: '{}',\n          createdAt: 2000,\n        }),\n      );\n\n      expect(ctx1.isEquivalent(ctx2)).toBe(true);\n    });\n  });\n\n  describe('function call output comparison', () => {\n    it('should return true for identical function call outputs', () => {\n      const ctx1 = new ChatContext();\n      ctx1.insert(\n        new FunctionCallOutput({\n          id: 'output_1',\n          callId: 'call_1',\n          name: 'get_weather',\n          output: '{\"temperature\": 22}',\n          isError: false,\n        }),\n      );\n\n      const ctx2 = new ChatContext();\n      ctx2.insert(\n        new FunctionCallOutput({\n          id: 'output_1',\n          callId: 'call_1',\n          name: 'get_weather',\n          output: '{\"temperature\": 22}',\n          isError: false,\n        }),\n      );\n\n      expect(ctx1.isEquivalent(ctx2)).toBe(true);\n    });\n\n    it('should return false for function call outputs with different names', () => {\n      const ctx1 = new ChatContext();\n      ctx1.insert(\n        new FunctionCallOutput({\n          id: 'output_1',\n          callId: 'call_1',\n          name: 'get_weather',\n          output: '{}',\n          isError: false,\n        }),\n      );\n\n      const ctx2 = new ChatContext();\n      ctx2.insert(\n        new FunctionCallOutput({\n          id: 'output_1',\n          callId: 'call_1',\n          name: 'get_time',\n          output: '{}',\n          isError: false,\n        }),\n      );\n\n      expect(ctx1.isEquivalent(ctx2)).toBe(false);\n    });\n\n    it('should return false for function call outputs with different call IDs', () => {\n      const ctx1 = new ChatContext();\n      ctx1.insert(\n        new FunctionCallOutput({\n          id: 'output_1',\n          callId: 'call_1',\n          name: 'get_weather',\n          output: '{}',\n          isError: false,\n        }),\n      );\n\n      const ctx2 = new ChatContext();\n      ctx2.insert(\n        new FunctionCallOutput({\n          id: 'output_1',\n          callId: 'call_2',\n          name: 'get_weather',\n          output: '{}',\n          isError: false,\n        }),\n      );\n\n      expect(ctx1.isEquivalent(ctx2)).toBe(false);\n    });\n\n    it('should return false for function call outputs with different output values', () => {\n      const ctx1 = new ChatContext();\n      ctx1.insert(\n        new FunctionCallOutput({\n          id: 'output_1',\n          callId: 'call_1',\n          name: 'get_weather',\n          output: '{\"temperature\": 22}',\n          isError: false,\n        }),\n      );\n\n      const ctx2 = new ChatContext();\n      ctx2.insert(\n        new FunctionCallOutput({\n          id: 'output_1',\n          callId: 'call_1',\n          name: 'get_weather',\n          output: '{\"temperature\": 25}',\n          isError: false,\n        }),\n      );\n\n      expect(ctx1.isEquivalent(ctx2)).toBe(false);\n    });\n\n    it('should return false for function call outputs with different error flags', () => {\n      const ctx1 = new ChatContext();\n      ctx1.insert(\n        new FunctionCallOutput({\n          id: 'output_1',\n          callId: 'call_1',\n          name: 'get_weather',\n          output: 'Error occurred',\n          isError: false,\n        }),\n      );\n\n      const ctx2 = new ChatContext();\n      ctx2.insert(\n        new FunctionCallOutput({\n          id: 'output_1',\n          callId: 'call_1',\n          name: 'get_weather',\n          output: 'Error occurred',\n          isError: true,\n        }),\n      );\n\n      expect(ctx1.isEquivalent(ctx2)).toBe(false);\n    });\n\n    it('should ignore timestamps', () => {\n      const ctx1 = new ChatContext();\n      ctx1.insert(\n        new FunctionCallOutput({\n          id: 'output_1',\n          callId: 'call_1',\n          name: 'get_weather',\n          output: '{}',\n          isError: false,\n          createdAt: 1000,\n        }),\n      );\n\n      const ctx2 = new ChatContext();\n      ctx2.insert(\n        new FunctionCallOutput({\n          id: 'output_1',\n          callId: 'call_1',\n          name: 'get_weather',\n          output: '{}',\n          isError: false,\n          createdAt: 2000,\n        }),\n      );\n\n      expect(ctx1.isEquivalent(ctx2)).toBe(true);\n    });\n  });\n\n  describe('complex context comparison', () => {\n    it('should return true for identical complex contexts', () => {\n      const ctx1 = new ChatContext();\n      ctx1.addMessage({\n        id: 'msg_1',\n        role: 'user',\n        content: 'What is the weather?',\n      });\n      ctx1.insert(\n        new FunctionCall({\n          id: 'func_1',\n          callId: 'call_1',\n          name: 'get_weather',\n          args: '{\"location\": \"Paris\"}',\n        }),\n      );\n      ctx1.insert(\n        new FunctionCallOutput({\n          id: 'output_1',\n          callId: 'call_1',\n          name: 'get_weather',\n          output: '{\"temperature\": 22}',\n          isError: false,\n        }),\n      );\n      ctx1.addMessage({\n        id: 'msg_2',\n        role: 'assistant',\n        content: 'The weather is 22°C',\n      });\n\n      const ctx2 = new ChatContext();\n      ctx2.addMessage({\n        id: 'msg_1',\n        role: 'user',\n        content: 'What is the weather?',\n      });\n      ctx2.insert(\n        new FunctionCall({\n          id: 'func_1',\n          callId: 'call_1',\n          name: 'get_weather',\n          args: '{\"location\": \"Paris\"}',\n        }),\n      );\n      ctx2.insert(\n        new FunctionCallOutput({\n          id: 'output_1',\n          callId: 'call_1',\n          name: 'get_weather',\n          output: '{\"temperature\": 22}',\n          isError: false,\n        }),\n      );\n      ctx2.addMessage({\n        id: 'msg_2',\n        role: 'assistant',\n        content: 'The weather is 22°C',\n      });\n\n      expect(ctx1.isEquivalent(ctx2)).toBe(true);\n    });\n  });\n});\n"],"mappings":"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","names":[]}